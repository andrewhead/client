<div dropdown keyboard-nav>
  <button class="btn dropdown-toggle group-list__toggle"
        dropdown-toggle
        data-toggle="dropdown"
        role="button"
        tabindex="0"
        ng-if="vm.showGroupsMenu()">
        Groups
        <i class="h-icon-arrow-drop-down top-bar__dropdown-arrow"></i>
  </button>
  <div class="dropdown-menu" role="menu" ng-if="vm.showGroupsMenu()">

    <!-- TODO: Fix org logo display -->
    <h2 class="dropdown-menu__section-heading dropdown-menu__section-heading--current">Currently Viewing</h2>
    <ul class="dropdown-menu__section dropdown-menu__section--current">
      <li class="dropdown-menu__row dropdown-menu__row--unpadded">
        <div ng-class="{'group-item': true}"
             ng-click="vm.focusGroup(vm.groups.focused().id)" tabindex="0">
          <!-- the group icon !-->
          <div class="group-menu-icon-container">
            <img class="group-list-label__icon group-list-label__icon--organization"
              alt="{{ vm.orgName(vm.groups.focused().id) }}"
              ng-src="{{ vm.groups.focused().logo }}"
              ng-if="vm.groups.focused().logo">
          </div>
          <!-- the group name and share link !-->
          <div class="group-details">
            {{vm.groups.focused().name}}
          </div>
        </div>
      </li>
    </ul>

    <!-- TODO: Add ng-if logic for Featured Groups -->
    <!-- TODO: Fix group info display (name, org logo, etc.) -->
    <h2 class="dropdown-menu__section-heading">Featured Groups</h2>
    <ul class="dropdown-menu__section">
      <li class="dropdown-menu__row dropdown-menu__row--unpadded">
        <div ng-class="{'group-item': true, selected: group.id == vm.groups.focused().id}"
             ng-click="vm.focusGroup(group.id)" tabindex="0">
          <!-- the group icon !-->
          <div class="group-menu-icon-container">
            <img class="group-list-label__icon group-list-label__icon--organization"
              alt="{{ vm.orgName(group.id) }}"
              ng-src="{{ group.logo }}"
              ng-if="group.logo">
          </div>
          <!-- the group name and share link !-->
          <div class="group-details">
            Example featured group
          </div>
        </div>
      </li>
    </ul>

    <!-- TODO: Convert to ng-repeat for current user's groups (pending API endpoint) -->
    <!-- TODO: Fix group info display (name, org logo, etc.) -->
    <h2 class="dropdown-menu__section-heading">My Groups</h2>
    <ul class="dropdown-menu__section">
      <li class="dropdown-menu__row dropdown-menu__row--unpadded"
          ng-repeat="group in vm.groupOrganizations() track by group.id">
        <div ng-class="{'group-item': true, selected: group.id == vm.groups.focused().id}"
             ng-click="vm.focusGroup(group.id)" tabindex="0">
          <!-- the group icon !-->
          <div class="group-menu-icon-container">
            <img class="group-list-label__icon group-list-label__icon--organization"
              alt="{{ vm.orgName(group.id) }}"
              ng-src="{{ group.logo }}"
              ng-if="group.logo">
          </div>
          <!-- the group name and share link !-->
          <div class="group-details">
            {{group.name}}
          </div>
        </div>
      </li>

      <!-- TODO: Integrate this display state into the My Groups loop, only
                 list items in this state if group is scoped, and out of scope -->
      <li class="dropdown-menu__row dropdown-menu__row--unpadded">
        <div class="group-item--oos"
             ng-class="{'group-item': true, selected: group.id == vm.groups.focused().id}"
             ng-click="vm.toggleGroupDetails()" tabindex="0">
          <!-- the group icon !-->
          <div class="group-menu-icon-container">
            <img class="group-list-label__icon group-list-label__icon--organization"
              alt="{{ vm.orgName(group.id) }}"
              ng-src="{{ group.logo }}"
              ng-if="group.logo">
          </div>
          <!-- the group name and share link !-->
          <div class="group-details" id="group-details-example">
            <svg class="svg-icon group__icon--unavailable" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24">
              <path fill="none" d="M0 0h24v24H0V0z"/>
              <path d="M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"/>
            </svg>
            Scoped group, out of scope<br>
            <p class="group-details__toggle">Why is this group unavailable?</p>
            <p class="group-details__unavailable-message">
              This group has been restricted to selected domains by its administrators.
            </p>
            <p class="group-details__actions">
              <a class="button button--text group-details__group-page-link" href="#">Go to group page</a>
            </p>
          </div>
        </div>
      </li>
    </ul>

    <ul class="dropdown-menu__section dropdown-menu__section--no-header">
      <li ng-if="vm.auth.status === 'logged-in' && !vm.isThirdPartyUser()" class="dropdown-menu__row dropdown-menu__row--unpadded new-group-btn">
        <div class="group-item" ng-click="vm.createNewGroup()" tabindex="0">
          <div class="group-icon-container"><i class="h-icon-add"></i></div>
          <div class="group-details">
            New private group
          </div>
        </div>
      </li>
    </ul>
  </div>
</div>
